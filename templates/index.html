<!DOCTYPE html>
<html>
<head><title>Повідомлення</title></head>
<body>
{% if session['username'] %}
  <p>Привіт, {{ session['username'] }}! <a href="/logout">Вийти</a></p>
{% endif %}
  <h1>Залиш повідомлення</h1>
  <form method="POST" action="/add">
    <input type="text" name="content" required>
    <button type="submit">Надіслати</button>
  </form>
  <h2>Історія:</h2>
  <ul id="message-list"></ul>
  <script>
  async function loadMessages() {
    const res = await fetch('/messages');
    const data = await res.json();
    const list = document.getElementById('message-list');
    list.innerHTML = '';
    data.forEach(msg => {
      const li = document.createElement('li');
      li.textContent = msg[1]; // msg[1] — текст повідомлення
      list.appendChild(li);
    });
  }

  // Завантажити одразу при відкритті
  loadMessages();

  // Оновлювати кожні 5 секунд
  setInterval(loadMessages, 5000);
</script>
</body>
</html>